<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="com.arch.mapper.security.UserMapper">
    <select id="getUsersCount" resultType="int">
    	select count(*) from SYS_USERS
    </select>
    
    <!-- 根据登录名查询用户 -->
    <select id="selectSysUserByName" parameterType="String" resultType="com.arch.entity.security.SysUsers">
    SELECT 
    	USER_ID userId ,
    	USER_NAME username,
    	NAME name,
    	PASSWORD password,
    	DT_CREATE  dtCreate ,
    	LAST_LOGIN lastLogin,
    	DEADLINE deadline,
    	LOGIN_IP loginIp, 
    	V_QZJGID VQzjgid,
    	V_QZJGMC VQzjgmc,
    	DEP_ID depId,
    	DEP_NAME depName , 
    	ENABLED enabled  , 
    	ACCOUNT_NON_EXPIRED accountNonExpired , 
    	ACCOUNT_NON_LOCKED accountNonLocked ,
    	CREDENTIALS_NON_EXPIRED credentialsNonExpired
	FROM SYS_USERS
		WHERE NAME=#{value}
    </select>
    <sql id="queryUsersConditions">
    	<if test="loginName !=null and loginName !=''">
    		AND NAME LIKE  '%${loginName}%'
    	</if>
    	<if test="beginDate !=null and beginDate !=''">
    		AND DT_CREATE > #{beginDate}
    	</if>
    	<if test="endDate !=null and endDate !=''">
    		AND #{endDate} >  DT_CREATE 
    	</if>
    </sql>
    
    
    <!-- 查询所有用户 -->
    <select id="queryUsers"  parameterType="com.arch.cmd.admin.AdminListQueryCmd"  resultType="com.arch.entity.security.SysUsers">
		SELECT 
    	USER_ID userId ,
    	USER_NAME username,
    	NAME name,
    	PASSWORD password,
    	DT_CREATE  dtCreate ,
    	LAST_LOGIN lastLogin,
    	DEADLINE deadline,
    	LOGIN_IP loginIp, 
    	V_QZJGID VQzjgid,
    	V_QZJGMC VQzjgmc,
    	DEP_ID depId,
    	DEP_NAME depName , 
    	ENABLED enabled  , 
    	ACCOUNT_NON_EXPIRED accountNonExpired , 
    	ACCOUNT_NON_LOCKED accountNonLocked ,
    	CREDENTIALS_NON_EXPIRED credentialsNonExpired
	FROM SYS_USERS
		WHERE 1=1
		<include refid="queryUsersConditions"/>
    </select>
    
    
      <!-- 查询所有用户总数 -->
    <select id="queryUsersCount"  parameterType="com.arch.cmd.admin.AdminListQueryCmd"  resultType="int">
		SELECT 
    	COUNT(USER_ID)
		FROM SYS_USERS
		WHERE 1=1
		<include refid="queryUsersConditions"/>
    </select>
</mapper> 